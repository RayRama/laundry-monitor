<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Laundry Monitor - TV Display</title>
    <link rel="stylesheet" href="/styles/main.css" />
    <link rel="stylesheet" href="/styles/monitor.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="container monitor-view">
      <!-- Header -->
      <header class="header">
        <div class="header-content">
          <div class="header-left">
            <h1>Laundry Monitor</h1>
            <span id="last-updated" aria-live="polite"
              >Terakhir diperbarui â€¢ --:--</span
            >
          </div>
          <div class="header-right">
            <button class="logout-btn monitor-logout-btn" title="Logout">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="w-5 h-5"
                viewBox="0 0 24 24"
                fill="currentColor"
              >
                <path
                  d="M16 17v-3H9v-4h7V7l5 5-5 5zM14 2c1.1 0 2 .9 2 2v2h-2V4H4v16h10v-2h2v2c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10z"
                />
              </svg>
              Logout
            </button>
          </div>
        </div>
      </header>

      <!-- Status Legend Row -->
      <!-- <div class="status-legend-row">
        <div class="legend-item">
          <div class="legend-icon ready"></div>
          <span>Tersedia</span>
        </div>
        <div class="legend-item">
          <div class="legend-icon running"></div>
          <span>Berjalan</span>
        </div>
        <div class="legend-item">
          <div class="legend-icon offline"></div>
          <span>Offline</span>
        </div>
      </div> -->

      <!-- Machine Grid -->
      <div class="machines-section">
        <!-- Desktop/Tablet/TV: Single Grid -->
        <div class="machines-wrap">
          <div class="parent" id="machineGrid">
            <!-- Mesin Washer (W1-W12) dan Dryer (D1-D12) akan di-render di sini -->
            <!-- Grid positions akan diatur via CSS grid-area -->
          </div>
        </div>

        <!-- Mobile: Separate Grids -->
        <div id="mobileGrids" class="mobile-grids">
          <div class="mobile-grid-section">
            <h3 class="mobile-grid-title">Washers</h3>
            <div class="status-legend-row">
              <div class="legend-section">
                <div class="legend-items">
                  <div class="legend-item">
                    <div class="legend-icon ready">
                      <span class="legend-count" id="washer-ready-count"
                        >0</span
                      >
                    </div>
                    <span class="legend-label">Tersedia</span>
                  </div>
                  <div class="legend-item">
                    <div class="legend-icon running">
                      <span class="legend-count" id="washer-running-count"
                        >0</span
                      >
                    </div>
                    <span class="legend-label">Berjalan</span>
                  </div>
                  <div class="legend-item">
                    <div class="legend-icon offline">
                      <span class="legend-count" id="washer-offline-count"
                        >0</span
                      >
                    </div>
                    <span class="legend-label">Offline</span>
                  </div>
                </div>
              </div>
            </div>
            <div id="washerGrid" class="parent mobile-grid"></div>
          </div>
          <div class="mobile-grid-section">
            <h3 class="mobile-grid-title">Dryers</h3>
            <div class="status-legend-row">
              <div class="legend-section">
                <div class="legend-items">
                  <div class="legend-item">
                    <div class="legend-icon ready">
                      <span class="legend-count" id="dryer-ready-count">0</span>
                    </div>
                    <span class="legend-label">Tersedia</span>
                  </div>
                  <div class="legend-item">
                    <div class="legend-icon running">
                      <span class="legend-count" id="dryer-running-count"
                        >0</span
                      >
                    </div>
                    <span class="legend-label">Berjalan</span>
                  </div>
                  <div class="legend-item">
                    <div class="legend-icon offline">
                      <span class="legend-count" id="dryer-offline-count"
                        >0</span
                      >
                    </div>
                    <span class="legend-label">Offline</span>
                  </div>
                </div>
              </div>
            </div>
            <div id="dryerGrid" class="parent mobile-grid"></div>
          </div>
        </div>
      </div>

      <!-- Cards Section -->
      <div class="cards" id="cards">
        <!-- ETA Card -->
        <div class="card eta-card">
          <h2>Mesin Berjalan</h2>
          <p>Teratas = hampir selesai</p>
          <div class="eta-table">
            <!-- <div class="eta-header">
              <div class="eta-col-header">Mesin</div>
              <div class="eta-col-header">Sisa Waktu</div>
            </div> -->
            <div class="eta-body" id="etaBody">
              <!-- Daftar ETA akan di-render di sini -->
            </div>
          </div>
        </div>

        <!-- Summary Card -->
        <div class="card summary-card">
          <h2>Tingkat Penggunaan</h2>
          <p
            style="
              text-align: center;
              color: var(--muted);
              margin-bottom: 1.5rem;
              font-size: 0.9rem;
            "
          >
            Persentase mesin yang sedang digunakan
          </p>
          <div class="occupation-text-display">
            <div class="occupation-item">
              <span class="occupation-label">Dryer:</span>
              <span class="occupation-rate" id="dryerOccupationRate"
                >0% occupation rate</span
              >
              <span class="occupation-details" id="dryerDetails"
                >(0 running + 0 offline out of 0 total)</span
              >
            </div>
            <div class="occupation-item">
              <span class="occupation-label">Washer:</span>
              <span class="occupation-rate" id="washerOccupationRate"
                >0% occupation rate</span
              >
              <span class="occupation-details" id="washerDetails"
                >(0 running + 0 offline out of 0 total)</span
              >
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Machine Control Modal (Start) -->
    <div id="machineModal" class="modal-overlay" style="display: none">
      <div class="modal-content">
        <div class="modal-header">
          <h3 id="modalTitle">Menyalakan Mesin</h3>
          <button id="modalCloseBtn" class="modal-close-btn" aria-label="Tutup">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="currentColor"
            >
              <path
                d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"
              />
            </svg>
          </button>
        </div>

        <div class="modal-body">
          <div class="machine-info">
            <div class="machine-icon">
              <svg
                id="modalMachineIcon"
                xmlns="http://www.w3.org/2000/svg"
                width="48"
                height="48"
                viewBox="0 0 24 24"
                fill="currentColor"
              >
                <!-- Default washer icon -->
                <path
                  d="M18 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM6 4h5v8H6V4zm0 10h5v6H6v-6zm7 0h5v6h-5v-6zm0-10h5v8h-5V4z"
                />
              </svg>
            </div>
            <div class="machine-details">
              <h4 id="modalMachineLabel">W01</h4>
              <p id="modalMachineBrand">Titan</p>
              <span id="modalMachineStatus" class="status-badge ready"
                >Tersedia</span
              >
            </div>
          </div>

          <!-- Event Selection -->
          <div class="event-selection">
            <label for="eventTypeSelect" class="event-selection-label"
              >Pilih Event <span class="required">*</span>:</label
            >
            <select id="eventTypeSelect" class="event-select-field" required>
              <option value="drop-off" selected>Drop-off</option>
              <option value="error-payment">Error Payment</option>
              <option value="claim-promo">Claim Promo</option>
              <option value="employee-quota">Employee Quota</option>
              <option value="maintenance">Maintenance</option>
            </select>
          </div>

          <!-- Event Form Fields (Conditional) -->
          <!-- Drop-off Fields -->
          <div
            id="eventFormDropOff"
            class="event-form-section"
            style="display: none"
          >
            <div class="event-form-field">
              <label for="customerName"
                >Nama Pelanggan <span class="required">*</span>:</label
              >
              <input
                type="text"
                id="customerName"
                class="event-input-field"
                placeholder="Masukkan nama pelanggan"
              />
            </div>
            <div class="event-form-field">
              <label for="customerPhone">Nomor Telepon <span class="required">*</span>:</label>
              <input
                type="text"
                id="customerPhone"
                class="event-input-field"
                placeholder="Masukkan nomor telepon"
              />
            </div>
            <div class="event-form-field">
              <label for="employeeSelectDropOff"
                >Karyawan <span class="required">*</span>:</label
              >
              <select id="employeeSelectDropOff" class="event-select-field" required>
                <option value="">Pilih karyawan...</option>
                <!-- Options akan di-populate dari JavaScript -->
              </select>
            </div>
            <div
              id="otherEmployeeNameGroupDropOff"
              class="event-form-field"
              style="display: none"
            >
              <label for="otherEmployeeNameDropOff"
                >Nama Karyawan Lainnya <span class="required">*</span>:</label
              >
              <input
                type="text"
                id="otherEmployeeNameDropOff"
                class="event-input-field"
                placeholder="Masukkan nama karyawan lainnya"
              />
            </div>
          </div>

          <!-- Error Payment Fields -->
          <div
            id="eventFormErrorPayment"
            class="event-form-section"
            style="display: none"
          >
            <div class="event-form-field">
              <label for="errorDescription"
                >Keterangan Error <span class="required">*</span>:</label
              >
              <input
                type="text"
                id="errorDescription"
                class="event-input-field"
                placeholder="Masukkan keterangan error"
              />
            </div>
            <div class="event-form-field">
              <label for="errorType"
                >Jenis Error <span class="required">*</span>:</label
              >
              <select id="errorType" class="event-select-field" required>
                <option value="">Pilih jenis error...</option>
                <option value="iot">IoT</option>
                <option value="konsumen">Konsumen</option>
              </select>
            </div>
            <div class="event-form-field">
              <label for="employeeSelectErrorPayment"
                >Karyawan <span class="required">*</span>:</label
              >
              <select id="employeeSelectErrorPayment" class="event-select-field" required>
                <option value="">Pilih karyawan...</option>
                <!-- Options akan di-populate dari JavaScript -->
              </select>
            </div>
            <div
              id="otherEmployeeNameGroupErrorPayment"
              class="event-form-field"
              style="display: none"
            >
              <label for="otherEmployeeNameErrorPayment"
                >Nama Karyawan Lainnya <span class="required">*</span>:</label
              >
              <input
                type="text"
                id="otherEmployeeNameErrorPayment"
                class="event-input-field"
                placeholder="Masukkan nama karyawan lainnya"
              />
            </div>
          </div>

          <!-- Claim Promo Fields -->
          <div
            id="eventFormClaimPromo"
            class="event-form-section"
            style="display: none"
          >
            <div class="event-form-field">
              <label>Jenis Promo <span class="required">*</span>:</label>
              <div class="maintenance-type-group">
                <label class="event-radio-option">
                  <input
                    type="radio"
                    name="promoType"
                    value="cuci_5_gratis_1"
                    id="promoTypeCuci5Gratis1"
                    checked
                  />
                  <span>Cuci 5 Gratis 1</span>
                </label>
                <label class="event-radio-option">
                  <input
                    type="radio"
                    name="promoType"
                    value="member_get_member"
                    id="promoTypeMemberGetMember"
                  />
                  <span>Member Get Member</span>
                </label>
              </div>
            </div>
            <div class="event-form-field">
              <label for="customerNameClaimPromo"
                >Nama Pelanggan <span class="required">*</span>:</label
              >
              <input
                type="text"
                id="customerNameClaimPromo"
                class="event-input-field"
                placeholder="Masukkan nama pelanggan"
              />
            </div>
            <div class="event-form-field">
              <label for="customerPhoneClaimPromo"
                >Nomor Telepon <span class="required">*</span>:</label
              >
              <input
                type="text"
                id="customerPhoneClaimPromo"
                class="event-input-field"
                placeholder="Masukkan nomor telepon"
              />
            </div>
             <div class="event-form-field">
              <label for="employeeSelectClaimPromo"
                >Karyawan <span class="required">*</span>:</label
              >
              <select id="employeeSelectClaimPromo" class="event-select-field" required>
                <option value="">Pilih karyawan...</option>
                <!-- Options akan di-populate dari JavaScript -->
              </select>
            </div>
            <div
              id="otherEmployeeNameGroupClaimPromo"
              class="event-form-field"
              style="display: none"
            >
              <label for="otherEmployeeNameClaimPromo"
                >Nama Karyawan Lainnya <span class="required">*</span>:</label
              >
              <input
                type="text"
                id="otherEmployeeNameClaimPromo"
                class="event-input-field"
                placeholder="Masukkan nama karyawan lainnya"
              />
            </div>
          </div>
          </div>

          <!-- Employee Quota Fields -->
          <div
            id="eventFormEmployeeQuota"
            class="event-form-section"
            style="display: none"
          >
            <div class="event-form-field">
              <label for="employeeName"
                >Nama Karyawan <span class="required">*</span>:</label
              >
              <input
                type="text"
                id="employeeName"
                class="event-input-field"
                placeholder="Masukkan nama karyawan"
              />
            </div>
          </div>

          <!-- Maintenance Fields -->
          <div
            id="eventFormMaintenance"
            class="event-form-section"
            style="display: none"
          >
            <div class="event-form-field">
              <label>Jenis Maintenance <span class="required">*</span>:</label>
              <div class="maintenance-type-group">
                <label class="event-radio-option">
                  <input
                    type="radio"
                    name="maintenanceType"
                    value="cuci_kosong"
                    id="maintenanceTypeCuciKosong"
                    checked
                  />
                  <span>Cuci Kosong</span>
                </label>
                <label class="event-radio-option">
                  <input
                    type="radio"
                    name="maintenanceType"
                    value="tube_clean"
                    id="maintenanceTypeTubeClean"
                  />
                  <span>Tube Clean</span>
                </label>
                <label class="event-radio-option">
                  <input
                    type="radio"
                    name="maintenanceType"
                    value="other"
                    id="maintenanceTypeOther"
                  />
                  <span>Other</span>
                </label>
              </div>
            </div>
            <div class="event-form-field">
              <label for="maintenanceNote">Catatan:</label>
              <textarea
                id="maintenanceNote"
                class="event-input-field"
                rows="3"
                placeholder="Masukkan catatan maintenance (opsional)"
              ></textarea>
            </div>
            <div class="event-form-field">
              <label for="employeeSelectMaintenance"
                >Karyawan <span class="required">*</span>:</label
              >
              <select id="employeeSelectMaintenance" class="event-select-field" required>
                <option value="">Pilih karyawan...</option>
                <!-- Options akan di-populate dari JavaScript -->
              </select>
            </div>
            <div
              id="otherEmployeeNameGroupMaintenance"
              class="event-form-field"
              style="display: none"
            >
              <label for="otherEmployeeNameMaintenance"
                >Nama Karyawan Lainnya <span class="required">*</span>:</label
              >
              <input
                type="text"
                id="otherEmployeeNameMaintenance"
                class="event-input-field"
                placeholder="Masukkan nama karyawan lainnya"
              />
            </div>
          </div>

          <div class="duration-input">
            <label for="durationInput">Durasi (menit):</label>
            <input
              type="number"
              id="durationInput"
              class="duration-field"
              min="1"
              max="180"
              value="1"
              placeholder="Masukkan durasi dalam menit"
            />
          </div>
        </div>

        <div class="modal-footer">
          <button id="modalCancelBtn" class="btn btn-secondary">Batal</button>
          <button id="modalStartBtn" class="btn btn-primary">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="currentColor"
            >
              <path d="M8 5v14l11-7z" />
            </svg>
            Mulai Mesin
          </button>
        </div>
      </div>
    </div>

    <!-- Machine Stop Modal (Stop) -->
    <div id="stopMachineModal" class="modal-overlay" style="display: none">
      <div class="modal-content">
        <div class="modal-header">
          <h3 id="stopModalTitle">Mematikan Mesin</h3>
          <button
            id="stopModalCloseBtn"
            class="modal-close-btn"
            aria-label="Tutup"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="currentColor"
            >
              <path
                d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"
              />
            </svg>
          </button>
        </div>

        <div class="modal-body">
          <div class="machine-info">
            <div class="machine-icon">
              <svg
                id="stopModalMachineIcon"
                xmlns="http://www.w3.org/2000/svg"
                width="48"
                height="48"
                viewBox="0 0 24 24"
                fill="currentColor"
              >
                <!-- Default washer icon -->
                <path
                  d="M18 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM6 4h5v8H6V4zm0 10h5v6H6v-6zm7 0h5v6h-5v-6zm0-10h5v8h-5V4z"
                />
              </svg>
            </div>
            <div class="machine-details">
              <h4 id="stopModalMachineLabel">W01</h4>
              <p id="stopModalMachineBrand">Titan</p>
              <span id="stopModalMachineStatus" class="status-badge running"
                >Berjalan</span
              >
            </div>
          </div>

          <div class="stop-confirmation">
            <div class="stop-warning">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="currentColor"
                style="color: #f59e0b; margin-right: 0.5rem; flex-shrink: 0"
              >
                <path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z" />
              </svg>
              <p>Apakah Anda yakin ingin mematikan mesin ini?</p>
            </div>
            <p
              style="color: var(--muted); font-size: 0.9rem; margin-top: 0.5rem"
            >
              Mesin yang dimatikan akan segera berhenti beroperasi.
            </p>
          </div>
        </div>

        <div class="modal-footer">
          <button id="stopModalCancelBtn" class="btn btn-secondary">
            Batal
          </button>
          <button id="stopModalStopBtn" class="btn btn-danger">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="currentColor"
            >
              <path d="M6 6h12v12H6z" />
            </svg>
            Matikan Mesin
          </button>
        </div>
      </div>
    </div>

    <!-- Scripts -->
    <script src="/scripts/auth.js"></script>
    <script src="/scripts/app.js"></script>
  </body>
</html>
